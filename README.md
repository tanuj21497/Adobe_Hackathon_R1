## **Documentation**

**Step 1: Getting JSON Files**

I proceeded with installing and using Adobe PDF Extract API. Using its **private.key**, **pdfservices-api-credentials.json,** and **extract\_txt\_table\_info\_with\_table\_structure\_from\_pdf.py** files I got a ZIP file containing JSON format of sample pdfs given, which will be further used to extract data from it to give the final ExtractData.csv file.

**Problems**: I used this **extract\_txt\_table\_info\_with\_table\_structure\_from\_pdf.py** file so that I can get a direct table structure, but it is only optimal when JSON format is well written which is not likely in our case. **To make CSV file right We have to write our own code. I am going to use Python.**

**Sources:** [DC Integration Creation App (adobe.com)](https://acrobatservices.adobe.com/dc-integration-creation-app-cdn/main.html?api=pdf-extract-api) -> To get credentials and .py files to use API.

**Step 2: Finding few common things between JSON Files, so that a single code will run correctly on all of them**

JSON files were not properly and orderly generated by API

Finding out that the JSON files are not in proper sequencing, I expected that just reading line by line JSON files text and adding to CSV file accordingly will solve the problem.

But those JSON files were not in proper ordering of sequencing, they are quite randomized.

So after knowing this only option left is to write some code to sequencing the randomization as well as putting the same information in CSV file.

Even when JSON files were randomized still there are some parts where they are well ordered, Analyzing those well ordered parts and and making the unordered parts well ordered using code will make overall structure well ordered which can be processed into CSV file.

**After analyzing the way API is actually working on well ordered parts I found out only these 3 levels of solving problem:**

1. **API IS ABLE TO DIFFERENTIATE TEXT BETWEEN LINES AND TABLES.** These horizontal lines in PDFs help me to differentiate between texts to some extent, as I can make sure some text generated by API in JSON is going to start from “BILL TO ” and not some random other text. Similarly for “ITEM ” as well.

   **But still I have to differentiate between text sandwiched between THESE LINES**.

  ![image](https://github.com/tanuj21497/Adobe_Hackathon_R1/assets/108824263/04f76746-d780-42bc-a029-206c7069bab4)


2. **TO DIFFERNTIATE TEXT BETWEEN THESE LINES. Use of Bound variable for same text, as it will remain fixed as long as format of Receipt is changed**

   Thinking of many variables so that I can find something common in all json files such that

   To differentiate text between lines we can take advantage of **Bounds variable in JSON file,** which actually show the position of text under some imaginary rectangle. As Format of Receipt is going to be same. For example BILL TO will remain there at that position, even there are different receipts.

   So, details below them also started vertically below them, hence there left position are going to remain same. Similarly for all text between lines. Hence we will be able to differentiate text between lines as well.

   As shown in figure using red lines these are some in between text that are going to be almost properly vertically aligned as its topic variable. Referring topic variable such as BILL TO, DETAILS, PAYMENT etc. If we found out mathematical position of these topic texts we will be able to differentiate between lines as well, and that is the same provided by Bounds variable in JSON file.

   ![image](https://github.com/tanuj21497/Adobe_Hackathon_R1/assets/108824263/42ea5087-4549-483b-828e-db77b49f1261)


3. **Now using the format of Receipt we can find our main details:**

   For example: in BILL TO Title: First came the NAME, then EMAIL, PHONE NO., STREET ADDRESS and at last CITY

   **Using text we get after 2nd point, we can get these as from 2nd they will be under a single string of text under various Topics Variable.**

   ![image](https://github.com/tanuj21497/Adobe_Hackathon_R1/assets/108824263/f8419b5b-d300-415f-912e-cd2bceaf406b)


**Step 3: Writing Python Code**

Using step 2 conditions we will be able to write a code which will generate CSV file with Extracted Data.

**EFFICIENCY OF MY CODE**

1. Using JSON library and extracting whole JSON in single variable is going to cost us Runtime Space of JSON file**(generally 50 KB).**

   But I used IJSON library which will extract single line of IJSON at one time and as we will be only storing text part in our code it will take only Runtime Space of text written (**generally less than 1 KB**). As analyzing the text, it is going to have normally around 1000 characters or less than that.

2. As one receipt is getting read only once hence **time taken by code is going to be one of the best**.
2. Many of the problems in API for example giving JSON format in uneven way is solved using Bound variable, which will cover **many edge cases as well**.
2. **Code is Universal if particular Format of receipt is fixed**. Even when Other than Nearby Electronics some other company would be there then it will also work fine.

**WHAT COULD BE BETTER IN CODE**

1\. Although code is going to cover almost all cases, But Step 2, 3rd part can be modified to make it more robust. As email, date, Street Address has some particular format that can be detected using **Regex.** Which will perfectly detect these details and will have almost zero chance of wrong output. Also the City can be found using **GEONAMES API**, which will help in finding City in long text string.

**A Sample PDF where API fails to Detect ![](Aspose.Words.0cc2d4d0-9448-49e3-9b9f-ce4e860b9a81.004.png)**(output81.pdf)

![image](https://github.com/tanuj21497/Adobe_Hackathon_R1/assets/108824263/ea7d4d0e-27da-4a19-8c04-970932199359)


To remove this discrepancy, I added if it fails to find tax value then put 10.


## **How to Run**
![image](https://github.com/tanuj21497/Adobe_Hackathon_R1/assets/108824263/c23d3ec6-1356-4542-b39e-f9175e1fedb5)


**NOTE: Make sure to run the code by changing the directory to where that code actually is.**

**Or**

**by right-clicking inside that folder and clicking on open with the code.**

**MAKING\_JSON** contains PDFs of samples, extracts API code, credentials, and private key Although I believe in Adobe's authorities, that’s why giving private key and credentials :) **Running extract\_txt\_table\_info\_with\_table\_structure\_from\_pdf.py** will make folders containing JSON Files.

**WITH\_JSON\_ONE\_GO** contains actual code written by me named as “**hackathon.py”**, **RUN THIS FILE TO CHECK MY CODE WORKING.** It already contains folders containing JSON files and will generate “ExtractedData.csv”.

**WITHOUT\_JSON\_ONE\_GO** contains PDFs, which will be converted by **“extract\_txt\_table\_info\_with\_table\_structure\_from\_pdf.py” to JSON Files containing folders and Automatically Run “hackathon.py”** as well, which will later generate **“ExtractedData.csv”.**

**DOCUMENTATION.pdf** contains my approach to the problem statement.

